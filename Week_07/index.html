<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Tutorial Demo</title>
  </head>
  <body>
    <div id="TreeChart"></div>
    <!-- 引入 G6 -->
    <script src="https://gw.alipayobjects.com/os/antv/pkg/_antv.g6-3.7.1/dist/g6.min.js"></script>

    <script>
        // 获取全部内置对象
        var set = new Set();
        var objects = [
            eval,
            isFinite,
            isNaN,
            parseFloat,
            parseInt,
            decodeURI,
            decodeURIComponent,
            encodeURI,
            encodeURIComponent,
            Array,
            // Date,
            RegExp,
            Promise,
            Proxy,
            Map,
            WeakMap,
            Set,
            WeakSet,
            Function,
            Boolean,
            String,
            Number,
            Symbol,
            Object,
            Error,
            EvalError,
            RangeError,
            ReferenceError,
            SyntaxError,
            TypeError,
            URIError,
            ArrayBuffer,
            SharedArrayBuffer,
            DataView,
            Float32Array,
            Float64Array,
            Int8Array,
            Int16Array,
            Int32Array,
            Uint8Array,
            Uint16Array,
            Uint32Array,
            Uint8ClampedArray,
            Atomics,
            JSON,
            Math,
            Reflect];
        objects.forEach(o => set.add(o));

        for(var i = 0; i < objects.length; i++) {
            var o = objects[i]
            for(var p of Object.getOwnPropertyNames(o)) {
                var d = Object.getOwnPropertyDescriptor(o, p)
                if( (d.value !== null && typeof d.value === "object") || (typeof d.value === "function"))
                    if(!set.has(d.value))
                        set.add(d.value), objects.push(d.value);
                if( d.get )
                    if(!set.has(d.get))
                        set.add(d.get), objects.push(d.get);
                if( d.set )
                    if(!set.has(d.set))
                        set.add(d.set), objects.push(d.set);
            }
        }

        // 内置对象加入 root 并格式化
        let root = {};
        root.isRoot = true;
        root.id = '1';
        root.type = 'image';
        root.label = 'Realm';
        root.children = [];

        let id = 1;
        for(let o of objects) {
            let obj = {};
            id++;
            obj.id = id.toString();
            obj.type = 'image';
            obj.label = o.name ? o.name : Object.prototype.toString.call(o);
            root.children.push(obj);
            // break;
        }
        // console.log(JSON.stringify(treedata));
        treedata = root;

        //初始化图定义
        var graph = new G6.TreeGraph({
            container: 'TreeChart', //容器
            width: window.innerWidth, //返回窗口的文档显示区的高度
            height: window.innerHeight,
            pixelRatio: 2,
            linkCenter: true,
            modes: {
                default: ['drag-canvas', 'zoom-canvas', 'dice-mindmap']
            },
            defaultNode: {
                size: 30
            },
            nodeStyle: {
                default: {
                    fill: '#40a9ff',
                    stroke: '#096dd9'
                }
            },
            edgeStyle: {
                default: {
                    stroke: '#A3B1BF'
                }
            },
            layout: {
                type: 'mindmap',
                direction: 'H',
                getId: function getId(d) {
                    return d.id;
                },
                getHeight: function getHeight() {
                    return 16;
                },
                getWidth: function getWidth() {
                    return 16;
                },
                getVGap: function getVGap() {
                    return 10;
                },
                getHGap: function getHGap() {
                    return 150;
                }
            },
            defaultEdge: {
                type: 'cubic-horizontal',
                style: {
                lineWidth: 2,
                },
            },
        });
        //定义节点
        graph.node(function(node) {
            return {
                size: 36,
                anchorPoints: [[0, 0.5], [1, 0.5]],
                style: {
                    fill: '#40a9ff',
                    stroke: '#096dd9'
                },
                //label: node.id,
                labelCfg: {
                    position: 'right'
                }
            };
        });
        graph.data(treedata);
        graph.render();
        graph.fitView();
        
    </script>
</body>
</html>